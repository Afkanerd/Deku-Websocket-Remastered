<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: users.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: users.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const {
    Sequelize,
    DataTypes,
    UUIDV4
} = require("sequelize");
const cred = require("../credentials.json")

// create connection : new Sequelize(database, username, password, {host, dialect})
const sequelize = new Sequelize(cred.DATABASE, cred.USERNAME, cred.PASSWORD, {
    host: cred.HOST,
    dialect: "mysql"
});

const user = sequelize.define("User", {
    uuid: {
        type: DataTypes.UUID,
        defaultValue: UUIDV4,
        primaryKey: true
    },
    name: DataTypes.STRING,
    token: DataTypes.STRING
})

/**
 * Class representing a user
 */
class Users {
    /**
     * authenticate user
     * @param {STRING} uuid 
     * @returns {Promise} Object {valid: BOOLEAN(true if found, false if not found)}
     */
    auth(uuid) {
        return new Promise(async (resolve, reject) => {
            try {
                var result = await this.find(uuid);
                if (result == "User not found") {
                    resolve({
                        valid: false
                    })
                }
                resolve({
                    valid: true
                })
            } catch (e) {
                reject(e)
            }
        })
    }
    /**
     * create a new user
     * @param {STRING} name first and last name
     * @param {STRING} token generated token
     * @returns {Promise} Object {uuid: STRING, name: STRING}
     */
    create(name, token) {
        return new Promise(async (resolve, reject) => {
            try {
                await user.sync();
                var newUser = await user.create({
                    name: name,
                    token: token
                })
                resolve({
                    uuid: newUser.uuid,
                    name: newUser.name
                })
            } catch (e) {
                reject(e)
            }
        })
    }

    /**
     * find a user by uuid
     * @param {STRING} uuid 
     * @returns {Promise} Object {uuid, name}
     */
    find(uuid) {
        return new Promise(async (resolve, reject) => {
            try {
                await user.sync();
                var found = await user.findAll({
                    where: {
                        uuid: uuid
                    },
                    raw: true
                })
                if (found.length &lt; 1) {
                    resolve("User not found")
                }
                resolve({
                    uuid: found[0].uuid,
                    name: found[0].name
                })
            } catch (e) {
                reject(e)
            }
        })
    }
}

// (async () => {
//     var inuser = new Users()
//     var name = "John Doe";
//     var token = "11ee";
//     var uuid = "01427117-7977-400b-bc31-978817e8cd8c"
//     var found = await inuser.auth(uuid);
//     console.log(found)
// })();

module.exports = Users</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="SMS.html">SMS</a></li><li><a href="Users.html">Users</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Mon Jan 04 2021 18:52:48 GMT+0100 (West Africa Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
